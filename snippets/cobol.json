{
  "Template batch": {
    "prefix": "cobol",
    "body": [
      "${1|      |}*================================================================*",
      "      * SISTEMA...: ACH - ACOMPANHAMENTO DE CHEQUE-OURO",
      "      * PROGRAMA..: ${TM_FILENAME_BASE}",
      "      * ANALISTA..: F7023235 - MATHEUS SANTIAGO",
      "      * AUTOR.....: F7023235 - MATHEUS SANTIAGO",
      "      * DATA......: $CURRENT_DATE/$CURRENT_MONTH/$CURRENT_YEAR",
      "      * COMPILACAO: 54 - PSOSE600 - Cobol 6.3 c/otimizacao p/producao",
      "      * OBJETIVO..: $0",
      "      *............ ",
      "      *================================================================*",
      "      *   VRS001  | $CURRENT_DATE/$CURRENT_MONTH/$CURRENT_YEAR F7023235 - IMPLANTAÇÃO",
      "      *================================================================*",
      "      *",
      "      *================================================================*",
      "      ************************* ",
      "       IDENTIFICATION DIVISION.",
      "        PROGRAM-ID. ${TM_FILENAME_BASE}.",
      "        AUTHOR. F7023235.",
      "      ************************* ",
      "      *",
      "      ********************** ",
      "       ENVIRONMENT DIVISION.",
      "      ********************** ",
      "       CONFIGURATION SECTION.",
      "       SPECIAL-NAMES.",
      "           DECIMAL-POINT IS COMMA.",
      "      *",
      "       INPUT-OUTPUT SECTION.",
      "      *",
      "       FILE-CONTROL.",
      "      *",
      "      ***************",
      "       DATA DIVISION.",
      "      ***************",
      "      *",
      "      *-----------------------------------------------------------------",
      "       FILE SECTION.",
      "      *-----------------------------------------------------------------",
      "      *",
      "      ",
      "      *",
      "      *-----------------------------------------------------------------",
      "       WORKING-STORAGE SECTION.",
      "      *-----------------------------------------------------------------",
      "      *",
      "       COPY ALMKCBL1. *> Book necessário para realizar o mock",
      "      *",
      "      *----------------------- P R O G R A M A S ----------------------*",
      "      *",
      "       01 TAB-PROGRAMAS-CHAMADOS.",
      "          03  SBVERSAO                     PIC  X(008) VALUE 'SBVERSAO'.",
      "          03  SBABEND                      PIC  X(007) VALUE 'SBABEND'.",
      "      *",
      "      *--------------------- C O N S T A N T E S ----------------------*",
      "      *",
      "       77  CTE-PROG                     PIC  X(016)",
      "                                        VALUE '*** ${TM_FILENAME_BASE} ***'.",
      "       77  CTE-VERS                     PIC  X(006) VALUE 'VRS001'.",
      "      *",
      "      *-------------------- I N D I C A D O R E S ---------------------*",
      "      *",
      "      *",
      "      *--------------------- C O N T A D O R E S ----------------------*",
      "      *",
      "      *",
      "      ********************",
      "       PROCEDURE DIVISION.",
      "      ********************",
      "      *",
      "      *----------------------------------------------------------------*",
      "       000000-ROTINA-PRINCIPAL                                  SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           CALL SBVERSAO USING CTE-PROG CTE-VERS.",
      "       ",
      "           PERFORM 100000-PROCEDIMENTOS-INICIAIS.",
      "      *",
      "           PERFORM 200000-PROCESSA.",
      "      *",
      "           PERFORM 300000-PROCEDIMENTOS-FINAIS.",
      "      *",
      "           STOP RUN.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       100000-PROCEDIMENTOS-INICIAIS                            SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           PERFORM 101000-ABRE-ARQUIVOS.",
      "       ",
      "       100099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       101000-ABRE-ARQUIVOS                                     SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "      ",
      "      *",
      "       101099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       200000-PROCESSA                                          SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "      ",
      "      *",
      "       200099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       300000-PROCEDIMENTOS-FINAIS                              SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           PERFORM 301000-FECHA-ARQUIVOS.",
      "       ",
      "      *",
      "       300099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       301000-FECHA-ARQUIVOS                                    SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "       ",
      "      *",
      "       301099-SAI.",
      "           EXIT.",
      "      *",
      "      *================================================================*",
      "       990000-ERROS                                             SECTION.",
      "      *================================================================*",
      "      *",
      "       990001-ERRO-01.",
      "           DISPLAY '================================================='.",
      "           DISPLAY '888 ' CTE-PROG ' 001 - ERRO NO FOO-BAR - '.",
      "           DISPLAY 'Lorem ipsum dolor sit amet, qui minim  '.",
      "           DISPLAY '================================================='.",
      "           PERFORM 999000-ABENDA.",
      "      *",
      "      *",
      "       990099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       999000-ABENDA                                            SECTION.",
      "      *----------------------------------------------------------------*",
      "           DISPLAY '888 ' CTE-PROG ' 888 CANCELADO'.",
      "           CALL SBABEND.",
      "           EXIT.",
      "      *====================== FIM ${TM_FILENAME_BASE} ============================*"
    ]
  },
  "Template subrotina": {
    "prefix": "subrotina",
    "body": [
      "${1|      |}*================================================================*",
      "      * SISTEMA...: ACH - ACOMPANHAMENTO DE CHEQUE-OURO",
      "      * PROGRAMA..: ${TM_FILENAME_BASE}",
      "      * ANALISTA..: F7023235 - MATHEUS SANTIAGO",
      "      * AUTOR.....: F7023235 - MATHEUS SANTIAGO",
      "      * DATA......: $CURRENT_DATE/$CURRENT_MONTH/$CURRENT_YEAR",
      "      * COMPILACAO: 54 - PSOSE600 - Cobol 6.3 c/otimizacao p/producao",
      "      * OBJETIVO..: $0",
      "      *............ ",
      "      *================================================================*",
      "      *   VRS001  | $CURRENT_DATE/$CURRENT_MONTH/$CURRENT_YEAR F7023235 - IMPLANTAÇÃO",
      "      *================================================================*",
      "      *",
      "      ************************* ",
      "       IDENTIFICATION DIVISION.",
      "        PROGRAM-ID. ${TM_FILENAME_BASE}.",
      "        AUTHOR. F7023235.",
      "      ************************* ",
      "      *",
      "      ********************** ",
      "       ENVIRONMENT DIVISION.",
      "      ********************** ",
      "       CONFIGURATION SECTION.",
      "       SPECIAL-NAMES.",
      "           DECIMAL-POINT IS COMMA.",
      "      *",
      "      ***************",
      "       DATA DIVISION.",
      "      ***************",
      "      *",
      "      *-----------------------------------------------------------------",
      "       WORKING-STORAGE SECTION.",
      "      *-----------------------------------------------------------------",
      "      *",
      "      *----------------------- P R O G R A M A S ----------------------*",
      "      *",
      "       ",
      "      *",
      "      *--------------------- C O N S T A N T E S ----------------------*",
      "      *",
      "       77  CTE-PROG                     PIC  X(016)",
      "                                        VALUE '*** ${TM_FILENAME_BASE} ***'.",
      "       77  CTE-VERS                     PIC  X(006) VALUE 'VRS001'.",
      "      *",
      "      *-----------------------------------------------------------------",
      "       LOCAL-STORAGE SECTION.",
      "      *-----------------------------------------------------------------",
      "      *",
      "           EXEC SQL",
      "              INCLUDE SQLCA",
      "           END-EXEC.",
      "      *",
      "      *-------------------- I N D I C A D O R E S ---------------------*",
      "      *",
      "       ",
      "      *",
      "      *--------------------- C O N T A D O R E S ----------------------*",
      "      *",
      "       ",
      "      *",
      "      *",
      "      *-----------------------  G U A R D A S -------------------------*",
      "      *",
      "       ",
      "      *",
      "      *-------------------------- B O O K S ---------------------------*",
      "      *",
      "       ",
      "      *",
      "      *",
      "      *-----------------------------------------------------------------",
      "       LINKAGE  SECTION.",
      "      *-----------------------------------------------------------------",
      "      *",
      "       01 DFHCOMMAREA.",
      "           03  ${TM_FILENAME_BASE}-ENTRADA.",
      "               05  ${TM_FILENAME_BASE}-E-AMBIENTE             PIC  X(0001).",
      "                   88 CND-${TM_FILENAME_BASE}-AMB-ONLINE    VALUE 'O'.",
      "                   88 CND-${TM_FILENAME_BASE}-AMB-BATCH     VALUE 'B'.",
      "           03  ${TM_FILENAME_BASE}-SAIDA.",
      "               05  ${TM_FILENAME_BASE}-CD-RTN               PIC  S9(004)  COMP.",
      "               05  ${TM_FILENAME_BASE}-CD-SQL-RTN           PIC  S9(003)  COMP-3.",
      "               05  ${TM_FILENAME_BASE}-MSG-RTN              PIC   X(100).",
      "      *",
      "      **************************************",
      "       PROCEDURE DIVISION USING DFHCOMMAREA.",
      "      **************************************",
      "      *",
      "      *----------------------------------------------------------------*",
      "       000000-ROTINA-PRINCIPAL                                  SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           PERFORM 100000-VALIDA-PARAMETROS.",
      "      *",
      "           MOVE 0                           TO ${TM_FILENAME_BASE}-CD-RTN.",
      "           PERFORM 999000-ENCERRAR.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       100000-VALIDA-PARAMETROS                                 SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "      *--- VALIDA TAMANHO DO EIBCALEN",
      "           IF EIBCALEN NOT EQUAL LENGTH OF DFHCOMMAREA",
      "              PERFORM 990001-ERRO-01",
      "           END-IF.",
      "      ",
      "      *--- VALIDA AMBIENTE DE CHAMADA",
      "           IF NOT ( ${TM_FILENAME_BASE}-E-AMBIENTE EQUAL 'O' OR 'B' )",
      "              PERFORM 990002-ERRO-02",
      "           END-IF.",
      "       ",
      "       100099-SAI.",
      "           EXIT.",
      "      *",
      "      *================================================================*",
      "       990000-ERROS                                             SECTION.",
      "      *================================================================*",
      "      *",
      "       990001-ERRO-01.",
      "           MOVE  1  TO ${TM_FILENAME_BASE}-CD-RTN.",
      "           MOVE 'EIBCALEN diverge do tamanho do book do ${TM_FILENAME_BASE}'",
      "                  TO ${TM_FILENAME_BASE}-MSG-RTN.",
      "       ",
      "           PERFORM 999000-ENCERRAR.",
      "       ",
      "       990002-ERRO-02.",
      "           MOVE  2  TO ${TM_FILENAME_BASE}-CD-RTN.",
      "           MOVE 'Ambiente de chamada invalido' TO ${TM_FILENAME_BASE}-MSG-RTN.",
      "       ",
      "           PERFORM 999000-ENCERRAR.",
      "      *",
      "      *",
      "       990099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       999000-ENCERRAR                                          SECTION.",
      "      *----------------------------------------------------------------*",
      "           GOBACK.",
      "      *====================== FIM ${TM_FILENAME_BASE} ============================*"
    ]
  },
  "Template IIB com SQL": {
    "prefix": "iibsql",
    "body": [
      "      *================================================================*",
      "      * SISTEMA...: ACH - ACOMPANHAMENTO DE CHEQUE-OURO",
      "      * PROGRAMA..: ${TM_FILENAME_BASE}",
      "      * ANALISTA..: F7023235 - MATHEUS SANTIAGO",
      "      * AUTOR.....: F7023235 - MATHEUS SANTIAGO",
      "      * DATA......: $CURRENT_DATE/$CURRENT_MONTH/$CURRENT_YEAR",
      "      * SERVICO...: 000000",
      "      * OPERACAO..: XXXXXXX.1",
      "      * COMPILACAO: 54 - PSOSE600 - Cobol 6.3 c/otimizacao p/producao",
      "      * OBJETIVO..:",
      "      * ...........",
      "      *================================================================*",
      "      *   VRS001  | $CURRENT_DATE/$CURRENT_MONTH/$CURRENT_YEAR F7023235 - IMPLANTAÇÃO",
      "      *================================================================*",
      "      *",
      "      *************************",
      "       IDENTIFICATION DIVISION.",
      "        PROGRAM-ID. ${TM_FILENAME_BASE}.",
      "        AUTHOR. F7023235.",
      "      *************************",
      "      *",
      "      **********************",
      "       ENVIRONMENT DIVISION.",
      "      **********************",
      "       CONFIGURATION SECTION.",
      "       SPECIAL-NAMES.",
      "           DECIMAL-POINT IS COMMA.",
      "      *",
      "      ***************",
      "       DATA DIVISION.",
      "      ***************",
      "      *",
      "      *-----------------------------------------------------------------",
      "       WORKING-STORAGE SECTION.",
      "      *-----------------------------------------------------------------",
      "      *",
      "       COPY ALMKCBL1. *> Book necessário para realizar o mock",
      "      *",
      "      *----------------------- P R O G R A M A S ----------------------*",
      "      *",
      "       01 TAB-PROGRAMAS-CHAMADOS.",
      "           03  SBTIMEDT                 PIC  X(008) VALUE 'SBTIMEDT'.",
      "",
      "      *",
      "      *--------------------- C O N S T A N T E S ----------------------*",
      "      *",
      "       77  CTE-PROG                     PIC  X(016)",
      "                                        VALUE '*** ${TM_FILENAME_BASE} ***'.",
      "       77  CTE-VERS                     PIC  X(006) VALUE 'VRS001'.",
      "      *",
      "      *-----------------------------------------------------------------",
      "       LOCAL-STORAGE SECTION.",
      "      *-----------------------------------------------------------------",
      "      *",
      "      *",
      "      *-------------------- I N D I C A D O R E S ---------------------*",
      "      *",
      "      *",
      "      *",
      "      *------------------- S U B S C R I T O R E S --------------------*",
      "      *",
      "       77  SBS                             PIC 9(08) VALUE ZEROS.",
      "      *",
      "      *-----------------------  G U A R D A S -------------------------*",
      "      *",
      "       77  GDA-RESP                        PIC S9(04) COMP VALUE ZEROES.",
      "       77  GDA-SEQL-ERRO                   PIC  9(05)  VALUE ZEROS.",
      "       77  GDA-TAM-RESPOSTA                PIC S9(08)  COMP VALUE ZEROS.",
      "       77  GDA-SQLCODE                     PIC  ++++9.",
      "       77  GDA-NOME-CANAL                  PIC  X(016) VALUE SPACES.",
      "      *",
      "       77  GDA-TIP-OCR-ERRO            PIC  9(002) VALUE 0.",
      "           88  ERRO-PROGRAMADO                     VALUE 0.",
      "           88  ERRO-PROGRAMA-ACIONADO              VALUE 1.",
      "           88  ERRO-SERVICO-OPERACAO-ACIONADA      VALUE 2.",
      "           88  ERRO-SQL                            VALUE 3.",
      "           88  ERRO-CICS                           VALUE 4.",
      "      *",
      "       01  GDA-PGM-ACND.",
      "           03  GDA-NM-PGM-ACND         PIC  X(008) VALUE SPACES.",
      "           03  GDA-CD-RTN-PGM-ACND     PIC  9(004) VALUE 0.",
      "           03  GDA-CD-SEQL-PGM-ACND    PIC  9(004) VALUE 0.",
      "           03  GDA-TX-RTN-PGM-ACND     PIC  X(120) VALUE SPACES.",
      "      *",
      "       01  GDA-OPR-ACND.",
      "           03  GDA-CD-SRVC-ACND        PIC  9(009) VALUE 0.",
      "           03  GDA-CD-VRS-SRVC-ACND    PIC  9(004) VALUE 0.",
      "           03  GDA-CD-OPR-ACND         PIC  9(008) VALUE 0.",
      "           03  GDA-CD-VRS-OPR-ACND     PIC  9(004) VALUE 0.",
      "           03  GDA-CD-ERRO-OPR-ACND    PIC  9(009) COMP VALUE 0.",
      "           03  GDA-TX-ERRO-OPR-ACND    PIC  X(120) VALUE SPACES.",
      "      *",
      "      *-------------------------- B O O K S ---------------------------*",
      "      *",
      "      *----------------------------------------------------------------*",
      "      * XXXXXXXX - Book de entrada do programa.                        *",
      "      *----------------------------------------------------------------*",
      "      *",
      "       COPY XXXXXXXX.",
      "      *",
      "      *----------------------------------------------------------------*",
      "      * IIBKSRVC - Interface com o sistema IIB                         *",
      "      *----------------------------------------------------------------*",
      "      *",
      "       COPY IIBKSRVC.",
      "      *",
      "      *----------------------------------------------------------------*",
      "      * IIBKOPRD - Book contendo o código do usuário logado            *",
      "      *----------------------------------------------------------------*",
      "      *",
      "       COPY IIBKOPRD.",
      "      *",
      "      *----------------------------------------------------------------*",
      "      * IIBKERRO - Variáveis para rotina de erro do IIB                *",
      "      *----------------------------------------------------------------*",
      "      *",
      "       COPY IIBKERRO.",
      "      *",
      "      *----------------------------------------------------------------*",
      "      * MSGKWMGA - Variáveis para acionamento do MSG1                  *",
      "      *----------------------------------------------------------------*",
      "      *",
      "       COPY MSGKWMGA.",
      "      *",
      "      *--------------------------- S Q L ------------------------------*",
      "      *",
      "           EXEC SQL",
      "              INCLUDE SQLCA",
      "           END-EXEC.",
      "      *",
      "      ********************",
      "       PROCEDURE DIVISION.",
      "      ********************",
      "      *",
      "       COPY ALMKCBL2. *> Book necessário para realizar o mock",
      "      *",
      "      *----------------------------------------------------------------*",
      "       000000-ROTINA-PRINCIPAL                                  SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "      *--- PROCEDIMENTOS INICIAIS",
      "           PERFORM 100000-INICIA-VARIAVEIS.",
      "           PERFORM 110000-VALIDA-SERVICO-IIB.",
      "           PERFORM 120000-RECEBE-DADOS-IIB.",
      "           PERFORM 130000-PEGA-NOME-CANAL.",
      "           PERFORM 140000-VALIDA-PARAMETROS.",
      "",
      "      *--- PROCESSA",
      "",
      "      *--- FINALIZA",
      "           PERFORM 300000-GRAVA-RETORNO-IIB.",
      "",
      "           EXEC CICS",
      "                RETURN",
      "           END-EXEC.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       100000-INICIA-VARIAVEIS                                  SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           INITIALIZE ${TM_FILENAME_BASE}-RQSC",
      "                      ${TM_FILENAME_BASE}-RPST",
      "                      MSGS001A-PRM.",
      "      *",
      "       100099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       110000-VALIDA-SERVICO-IIB                                SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           EXEC CICS GET",
      "              CONTAINER ( 'PRM-RQSC-SRVC'              )",
      "                   INTO ( SRVC-PRM-RQSC-SRVC           )",
      "                FLENGTH ( LENGTH OF SRVC-PRM-RQSC-SRVC )",
      "                   RESP ( GDA-RESP                     )",
      "           END-EXEC.",
      "      *",
      "           IF GDA-RESP NOT EQUAL DFHRESP(NORMAL)",
      "              MOVE 01                TO GDA-SEQL-ERRO",
      "              PERFORM 990100-ERRO-CICS",
      "           END-IF.",
      "",
      "      *--- Valida servico e operação correspondentes a transação execu-",
      "      *--- tada.",
      "           IF ((SRVC-ID-SRVC NOT NUMERIC)       OR",
      "               (SRVC-ID-SRVC NOT EQUAL ZEROS))  OR",
      "              ((SRVC-ID-OPR  NOT NUMERIC)       OR",
      "               (SRVC-ID-OPR  NOT EQUAL CTE-ID-OPR))",
      "               PERFORM 990001-ERRO-01",
      "           END-IF.",
      "",
      "      *",
      "       110099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       120000-RECEBE-DADOS-IIB                                  SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           EXEC CICS GET",
      "               CONTAINER ( '${TM_FILENAME_BASE}-RQSC'  )",
      "               NODATA",
      "               FLENGTH   ( GDA-TAM-RESPOSTA )",
      "               RESP      ( GDA-RESP         )",
      "           END-EXEC.",
      "      *",
      "           IF GDA-RESP NOT EQUAL DFHRESP(NORMAL)",
      "              MOVE 02 TO GDA-SEQL-ERRO",
      "              PERFORM 990100-ERRO-CICS",
      "           END-IF",
      "",
      "",
      "           EXEC CICS GET",
      "               CONTAINER ( '${TM_FILENAME_BASE}-RQSC'  )",
      "               INTO      ( ${TM_FILENAME_BASE}-RQSC    )",
      "               FLENGTH   ( GDA-TAM-RESPOSTA )",
      "               RESP      ( GDA-RESP         )",
      "           END-EXEC.",
      "",
      "           IF GDA-RESP NOT EQUAL DFHRESP(NORMAL)",
      "              MOVE 03 TO GDA-SEQL-ERRO",
      "              PERFORM 990100-ERRO-CICS",
      "           END-IF.",
      "      *",
      "       120099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       130000-PEGA-NOME-CANAL                                   SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           EXEC CICS ASSIGN",
      "              CHANNEL ( GDA-NOME-CANAL )",
      "              RESP    ( GDA-RESP       )",
      "           END-EXEC",
      "",
      "           IF GDA-RESP NOT EQUAL DFHRESP(NORMAL)",
      "               MOVE 004 TO GDA-SEQL-ERRO",
      "               PERFORM 990100-ERRO-CICS",
      "           END-IF.",
      "      *",
      "       130099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       140000-VALIDA-PARAMETROS                                 SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "",
      "      *",
      "       140099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       300000-GRAVA-RETORNO-IIB                                 SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           EXEC CICS PUT",
      "               CONTAINER ( '${TM_FILENAME_BASE}-RPST'         )",
      "                    FROM ( ${TM_FILENAME_BASE}-RPST           )",
      "                 FLENGTH ( LENGTH OF ${TM_FILENAME_BASE}-RPST )",
      "                    RESP ( GDA-RESP                )",
      "           END-EXEC",
      "      *",
      "           IF GDA-RESP NOT EQUAL DFHRESP(NORMAL)",
      "               MOVE 005 TO GDA-SEQL-ERRO",
      "               PERFORM 990100-ERRO-CICS",
      "           END-IF.",
      "",
      "           IF IIBKERRO-CD-ERRO EQUAL 0",
      "              MOVE ' EXECUTADO COM SUCESSO.'   TO IIBKERRO-TX-ERRO",
      "           END-IF.",
      "      *",
      "       300099-SAI.",
      "           EXIT.",
      "      *",
      "      *=================================================================",
      "      * TRATAMENTO DE ERROS",
      "      *=================================================================",
      "      *",
      "      *----------------------------------------------------------------*",
      "       990001-ERRO-01                                           SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           SET ERRO-PROGRAMADO        TO TRUE.",
      "           MOVE 001                   TO MSG1A-CD-ERRO",
      "                                         IIBKERRO-CD-ERRO.",
      "           MOVE 001                   TO MSG1A-CD-SEQL-ERRO.",
      "      *    -------------------------------------------------------------",
      "           MOVE 'Ocorreu um erro, tente novamente.' TO IIBKERRO-TX-ERRO.",
      "      *    -------------------------------------------------------------",
      "           PERFORM 990300-GRAVA-ERRO-IIB.",
      "           PERFORM 999999-ABENDA.",
      "      *",
      "       990001-ERRO-01-SAI.",
      "           EXIT.",
      "",
      "      *",
      "      *----------------------------------------------------------------*",
      "       990100-ERRO-CICS                                         SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           SET ERRO-CICS              TO TRUE.",
      "           MOVE 999                   TO MSG1A-CD-ERRO",
      "                                         IIBKERRO-CD-ERRO.",
      "           MOVE GDA-SEQL-ERRO         TO MSG1A-CD-SEQL-ERRO.",
      "           MOVE 'Transação indisponível, tente mais tarde.'",
      "                                      TO IIBKERRO-TX-ERRO.",
      "",
      "           PERFORM 990300-GRAVA-ERRO-IIB.",
      "           PERFORM 999999-ABENDA.",
      "      *",
      "       990199-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       990200-VRV-MONITORADA-ENTRADA                            SECTION.",
      "      *----------------------------------------------------------------*",
      "      * Coloca as variáveis de entrada para serem monitoradas pelo MSG1",
      "      *----------------------------------------------------------------*",
      "      *",
      "      *--- Exemplo: input de agencia e conta",
      "      *    SET IC-X                    TO 1.",
      "      *    MOVE '${TM_FILENAME_BASE}-CD-UOR-CC-E' TO MSG1A-NM-VRV-MON(IC-X).",
      "      *    MOVE ${TM_FILENAME_BASE}-CD-UOR-CC-E   TO MSG1A-VL-VRV-MON(IC-X).",
      "      *    ADD 1                       TO MSG1A-QT-VRV-MNT.",
      "      *    -----------------------------------------------------",
      "      *    SET IC-X UP BY 1.",
      "      *    MOVE '${TM_FILENAME_BASE}-NR-CC-E'     TO MSG1A-NM-VRV-MON(IC-X).",
      "      *    MOVE ${TM_FILENAME_BASE}-NR-CC-E       TO MSG1A-VL-VRV-MON(IC-X).",
      "      *    ADD 1                       TO MSG1A-QT-VRV-MNT.",
      "      *",
      "       990299-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       990300-GRAVA-ERRO-IIB                                    SECTION.",
      "      *----------------------------------------------------------------*",
      "      * Monta o Registro de Erro do IIB",
      "      *----------------------------------------------------------------*",
      "           MOVE IIBKERRO-TX-ERRO            TO MSG1A-TX-ERRO.",
      "",
      "           EVALUATE TRUE",
      "               WHEN ERRO-PROGRAMADO",
      "                   CONTINUE",
      "               WHEN ERRO-PROGRAMA-ACIONADO",
      "                   SET IC-X UP BY 1",
      "                   MOVE 'Programa acionado' TO MSG1A-NM-VRV-MON(IC-X)",
      "                   MOVE GDA-NM-PGM-ACND     TO MSG1A-VL-VRV-MON(IC-X)",
      "                   ADD 1                    TO MSG1A-QT-VRV-MNT",
      "      *            ----------------------------------------------",
      "                   SET IC-X UP BY 1",
      "                   MOVE 'Codigo de retorno do programa'",
      "                                            TO MSG1A-NM-VRV-MON(IC-X)",
      "                   MOVE GDA-CD-RTN-PGM-ACND",
      "                                            TO MSG1A-VL-VRV-MON(IC-X)",
      "      *            ----------------------------------------------",
      "                   ADD 1                    TO MSG1A-QT-VRV-MNT",
      "                   SET IC-X UP BY 1",
      "                   MOVE 'Sequencial do erro do programa'",
      "                                            TO MSG1A-NM-VRV-MON(IC-X)",
      "                   MOVE GDA-CD-SEQL-PGM-ACND",
      "                                            TO MSG1A-VL-VRV-MON(IC-X)",
      "                   ADD 1                    TO MSG1A-QT-VRV-MNT",
      "      *            ----------------------------------------------",
      "                   SET IC-X UP BY 1",
      "                   MOVE 'Texto de retorno do programa'",
      "                                            TO MSG1A-NM-VRV-MON(IC-X)",
      "                   MOVE GDA-TX-RTN-PGM-ACND",
      "                                            TO MSG1A-VL-VRV-MON(IC-X)",
      "                   ADD 1                    TO MSG1A-QT-VRV-MNT",
      "",
      "               WHEN ERRO-SERVICO-OPERACAO-ACIONADA",
      "                   MOVE SRVC-ID-SRVC        TO GDA-CD-SRVC-ACND",
      "                   MOVE SRVC-VRS-SRVC       TO GDA-CD-VRS-SRVC-ACND",
      "                   MOVE SRVC-ID-OPR         TO GDA-CD-OPR-ACND",
      "                   MOVE SRVC-VRS-OPR        TO GDA-CD-VRS-OPR-ACND",
      "      *            ---------------------------------------------",
      "                   SET IC-X UP BY 1",
      "                   MOVE 'GDA-OPR-ACND'      TO MSG1A-NM-VRV-MON(IC-X)",
      "                   MOVE GDA-OPR-ACND        TO MSG1A-VL-VRV-MON(IC-X)",
      "                   ADD 1                    TO MSG1A-QT-VRV-MNT",
      "",
      "               WHEN ERRO-SQL",
      "                   MOVE SQLCODE             TO GDA-SQLCODE",
      "      *            ----------------------------------------------",
      "                   SET IC-X UP BY 1",
      "                   MOVE 'SQLCODE'           TO MSG1A-NM-VRV-MON(IC-X)",
      "                   MOVE GDA-SQLCODE         TO MSG1A-VL-VRV-MON(IC-X)",
      "                   ADD 1                    TO MSG1A-QT-VRV-MNT",
      "",
      "               WHEN ERRO-CICS",
      "                   SET IC-X                 TO 1",
      "                   MOVE 'EIBRESP'           TO MSG1A-NM-VRV-MON(IC-X)",
      "                   MOVE EIBRESP             TO MSG1A-VL-VRV-MON(IC-X)",
      "                   ADD 1                    TO MSG1A-QT-VRV-MNT",
      "      *            ----------------------------------------------",
      "                   SET IC-X UP BY 1",
      "                   MOVE 'EIBRESP2'          TO MSG1A-NM-VRV-MON(IC-X)",
      "                   MOVE EIBRESP2            TO MSG1A-VL-VRV-MON(IC-X)",
      "                   ADD 1                    TO MSG1A-QT-VRV-MNT",
      "           END-EVALUATE.",
      "      *",
      "           PERFORM MSG1A-NTF-MSG.",
      "",
      "           IF NOT MSG1A-OK-EXEC",
      "              PERFORM 990300-GRAVA-ERRO-INTEGRACAO",
      "              PERFORM 999999-ABENDA",
      "           END-IF.",
      "",
      "           MOVE MSG1A-CD-ERRO               TO IIBKERRO-CD-ERRO.",
      "           MOVE MSG1A-TX-ERRO               TO IIBKERRO-TX-ERRO.",
      "",
      "           EXEC CICS PUT",
      "              CONTAINER ( 'PRM-ERRO'                  )",
      "                   FROM ( IIBKERRO-PRM-ERRO           )",
      "                FLENGTH ( LENGTH OF IIBKERRO-PRM-ERRO )",
      "               NOHANDLE",
      "           END-EXEC.",
      "      *",
      "       990399-SAI.",
      "           EXIT.",
      "",
      "      *",
      "      *----------------------------------------------------------------*",
      "       990300-GRAVA-ERRO-INTEGRACAO                             SECTION.",
      "      *----------------------------------------------------------------*",
      "      * Monta o Registro de Erro Integração",
      "      *----------------------------------------------------------------*",
      "      *",
      "           EXEC CICS PUT",
      "              CONTAINER ( 'PRM-ERRO'                  )",
      "                CHANNEL ( GDA-NOME-CANAL              )",
      "                   FROM ( IIBKERRO-PRM-ERRO           )",
      "                FLENGTH ( LENGTH OF IIBKERRO-PRM-ERRO )",
      "               NOHANDLE",
      "           END-EXEC.",
      "      *",
      "       990399-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       999999-ABENDA                                            SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           EXEC CICS",
      "               RETURN",
      "               NOHANDLE",
      "           END-EXEC.",
      "      *",
      "       999999-SAI.",
      "           EXIT.",
      "      *",
      "       COPY MSGKPMGA. *> Book de notificação do MSG",
      "      *====================== FIM ${TM_FILENAME_BASE} ============================*"
    ]
  }
}
