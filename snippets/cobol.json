{
  "Template batch": {
    "prefix": "cobol",
    "body": [
      "${1|      |}*================================================================*",
      "      * SISTEMA...: ACH - ACOMPANHAMENTO DE CHEQUE-OURO",
      "      * PROGRAMA..: ${TM_FILENAME_BASE}",
      "      * ANALISTA..: F7023235 - MATHEUS SANTIAGO",
      "      * AUTOR.....: F7023235 - MATHEUS SANTIAGO",
      "      * DATA......: $CURRENT_DATE/$CURRENT_MONTH/$CURRENT_YEAR",
      "      * COMPILACAO: 54 - PSOSE600 - Cobol 6.3 c/otimizacao p/producao",
      "      * OBJETIVO..: $0",
      "      *............ ",
      "      *================================================================*",
      "      *  [VRS001] | $CURRENT_DATE/$CURRENT_MONTH/$CURRENT_YEAR F7023235 - IMPLANTAÇÃO",
      "      *================================================================*",
      "      *",
      "      *================================================================*",
      "      ************************* ",
      "       IDENTIFICATION DIVISION.",
      "        PROGRAM-ID. ${TM_FILENAME_BASE}.",
      "        AUTHOR. F7023235.",
      "      ************************* ",
      "      *",
      "      ********************** ",
      "       ENVIRONMENT DIVISION.",
      "      ********************** ",
      "       CONFIGURATION SECTION.",
      "       SPECIAL-NAMES.",
      "           DECIMAL-POINT IS COMMA.",
      "      *",
      "       INPUT-OUTPUT SECTION.",
      "      *",
      "       FILE-CONTROL.",
      "      *",
      "      ***************",
      "       DATA DIVISION.",
      "      ***************",
      "      *",
      "      *-----------------------------------------------------------------",
      "       FILE SECTION.",
      "      *-----------------------------------------------------------------",
      "      *",
      "      ",
      "      *",
      "      *-----------------------------------------------------------------",
      "       WORKING-STORAGE SECTION.",
      "      *-----------------------------------------------------------------",
      "      *",
      "       COPY ALMKCBL1. *> Book necessário para realizar o mock",
      "      *",
      "      *----------------------- P R O G R A M A S ----------------------*",
      "      *",
      "       01 TAB-PROGRAMAS-CHAMADOS.",
      "          03  SBVERSAO                     PIC  X(008) VALUE 'SBVERSAO'.",
      "          03  SBABEND                      PIC  X(007) VALUE 'SBABEND'.",
      "      *",
      "      *--------------------- C O N S T A N T E S ----------------------*",
      "      *",
      "       77  CTE-PROG                     PIC  X(016)",
      "                                        VALUE '*** ${TM_FILENAME_BASE} ***'.",
      "       77  CTE-VERS                     PIC  X(006) VALUE 'VRS001'.",
      "      *",
      "      *-------------------- I N D I C A D O R E S ---------------------*",
      "      *",
      "      *",
      "      *--------------------- C O N T A D O R E S ----------------------*",
      "      *",
      "      *",
      "      ********************",
      "       PROCEDURE DIVISION.",
      "      ********************",
      "      *",
      "      *----------------------------------------------------------------*",
      "       000000-ROTINA-PRINCIPAL                                  SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           CALL SBVERSAO USING CTE-PROG CTE-VERS.",
      "       ",
      "           PERFORM 100000-PROCEDIMENTOS-INICIAIS.",
      "      *",
      "           PERFORM 200000-PROCESSA.",
      "      *",
      "           PERFORM 300000-PROCEDIMENTOS-FINAIS.",
      "      *",
      "           STOP RUN.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       100000-PROCEDIMENTOS-INICIAIS                            SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           PERFORM 101000-ABRE-ARQUIVOS.",
      "       ",
      "       100099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       101000-ABRE-ARQUIVOS                                     SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "      ",
      "      *",
      "       101099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       200000-PROCESSA                                          SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "      ",
      "      *",
      "       200099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       300000-PROCEDIMENTOS-FINAIS                              SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           PERFORM 301000-FECHA-ARQUIVOS.",
      "       ",
      "      *",
      "       300099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       301000-FECHA-ARQUIVOS                                    SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "       ",
      "      *",
      "       301099-SAI.",
      "           EXIT.",
      "      *",
      "      *================================================================*",
      "       990000-ERROS                                             SECTION.",
      "      *================================================================*",
      "      *",
      "       990001-ERRO-01.",
      "           DISPLAY '================================================='.",
      "           DISPLAY '888 ' CTE-PROG ' 001 - ERRO NO FOO-BAR - '.",
      "           DISPLAY 'Lorem ipsum dolor sit amet, qui minim  '.",
      "           DISPLAY '================================================='.",
      "           PERFORM 999000-ABENDA.",
      "      *",
      "      *",
      "       990099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       999000-ABENDA                                            SECTION.",
      "      *----------------------------------------------------------------*",
      "           DISPLAY '888 ' CTE-PROG ' 888 CANCELADO'.",
      "           CALL SBABEND.",
      "           EXIT.",
      "      *====================== FIM ${TM_FILENAME_BASE} ============================*"
    ]
  },
  "Template subrotina": {
    "prefix": "subrotina",
    "body": [
      "${1|      |}*================================================================*",
      "      * SISTEMA...: ACH - ACOMPANHAMENTO DE CHEQUE-OURO",
      "      * PROGRAMA..: ${TM_FILENAME_BASE}",
      "      * ANALISTA..: F7023235 - MATHEUS SANTIAGO",
      "      * AUTOR.....: F7023235 - MATHEUS SANTIAGO",
      "      * DATA......: $CURRENT_DATE/$CURRENT_MONTH/$CURRENT_YEAR",
      "      * COMPILACAO: 54 - PSOSE600 - Cobol 6.3 c/otimizacao p/producao",
      "      * OBJETIVO..: $0",
      "      *............ ",
      "      *================================================================*",
      "      *  [VRS001] | $CURRENT_DATE/$CURRENT_MONTH/$CURRENT_YEAR F7023235 - IMPLANTAÇÃO",
      "      *================================================================*",
      "      *",
      "      ************************* ",
      "       IDENTIFICATION DIVISION.",
      "        PROGRAM-ID. ${TM_FILENAME_BASE}.",
      "        AUTHOR. F7023235.",
      "      ************************* ",
      "      *",
      "      ********************** ",
      "       ENVIRONMENT DIVISION.",
      "      ********************** ",
      "       CONFIGURATION SECTION.",
      "       SPECIAL-NAMES.",
      "           DECIMAL-POINT IS COMMA.",
      "      *",
      "      ***************",
      "       DATA DIVISION.",
      "      ***************",
      "      *",
      "      *-----------------------------------------------------------------",
      "       WORKING-STORAGE SECTION.",
      "      *-----------------------------------------------------------------",
      "      *",
      "      *----------------------- P R O G R A M A S ----------------------*",
      "      *",
      "       ",
      "      *",
      "      *--------------------- C O N S T A N T E S ----------------------*",
      "      *",
      "       77  CTE-PROG                     PIC  X(016)",
      "                                        VALUE '*** ${TM_FILENAME_BASE} ***'.",
      "       77  CTE-VERS                     PIC  X(006) VALUE 'VRS001'.",
      "      *",
      "      *-----------------------------------------------------------------",
      "       LOCAL-STORAGE SECTION.",
      "      *-----------------------------------------------------------------",
      "      *",
      "           EXEC SQL",
      "              INCLUDE SQLCA",
      "           END-EXEC.",
      "      *",
      "      *-------------------- I N D I C A D O R E S ---------------------*",
      "      *",
      "       ",
      "      *",
      "      *--------------------- C O N T A D O R E S ----------------------*",
      "      *",
      "       ",
      "      *",
      "      *",
      "      *-----------------------  G U A R D A S -------------------------*",
      "      *",
      "       ",
      "      *",
      "      *-------------------------- B O O K S ---------------------------*",
      "      *",
      "       ",
      "      *",
      "      *",
      "      *-----------------------------------------------------------------",
      "       LINKAGE  SECTION.",
      "      *-----------------------------------------------------------------",
      "      *",
      "       01 DFHCOMMAREA.",
      "           03  ${TM_FILENAME_BASE}-ENTRADA.",
      "               05  ${TM_FILENAME_BASE}-E-AMBIENTE             PIC  X(0001).",
      "                   88 CND-${TM_FILENAME_BASE}-AMB-ONLINE    VALUE 'O'.",
      "                   88 CND-${TM_FILENAME_BASE}-AMB-BATCH     VALUE 'B'.",
      "           03  ${TM_FILENAME_BASE}-SAIDA.",
      "               05  ${TM_FILENAME_BASE}-CD-RTN               PIC  S9(004)  COMP.",
      "               05  ${TM_FILENAME_BASE}-CD-SQL-RTN           PIC  S9(003)  COMP-3.",
      "               05  ${TM_FILENAME_BASE}-MSG-RTN              PIC   X(100).",
      "      *",
      "      **************************************",
      "       PROCEDURE DIVISION USING DFHCOMMAREA.",
      "      **************************************",
      "      *",
      "      *----------------------------------------------------------------*",
      "       000000-ROTINA-PRINCIPAL                                  SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           PERFORM 100000-VALIDA-PARAMETROS.",
      "      *",
      "           MOVE 0                           TO ${TM_FILENAME_BASE}-CD-RTN.",
      "           PERFORM 999000-ENCERRAR.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       100000-VALIDA-PARAMETROS                                 SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "      *--- VALIDA TAMANHO DO EIBCALEN",
      "           IF EIBCALEN NOT EQUAL LENGTH OF DFHCOMMAREA",
      "              PERFORM 990001-ERRO-01",
      "           END-IF.",
      "      ",
      "      *--- VALIDA AMBIENTE DE CHAMADA",
      "           IF NOT ( ${TM_FILENAME_BASE}-E-AMBIENTE EQUAL 'O' OR 'B' )",
      "              PERFORM 990002-ERRO-02",
      "           END-IF.",
      "       ",
      "       100099-SAI.",
      "           EXIT.",
      "      *",
      "      *================================================================*",
      "       990000-ERROS                                             SECTION.",
      "      *================================================================*",
      "      *",
      "       990001-ERRO-01.",
      "           MOVE  1  TO ${TM_FILENAME_BASE}-CD-RTN.",
      "           MOVE 'EIBCALEN diverge do tamanho do book do ${TM_FILENAME_BASE}'",
      "                  TO ${TM_FILENAME_BASE}-MSG-RTN.",
      "       ",
      "           PERFORM 999000-ENCERRAR.",
      "       ",
      "       990002-ERRO-02.",
      "           MOVE  2  TO ${TM_FILENAME_BASE}-CD-RTN.",
      "           MOVE 'Ambiente de chamada invalido' TO ${TM_FILENAME_BASE}-MSG-RTN.",
      "       ",
      "           PERFORM 999000-ENCERRAR.",
      "      *",
      "      *",
      "       990099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       999000-ENCERRAR                                          SECTION.",
      "      *----------------------------------------------------------------*",
      "           GOBACK.",
      "      *====================== FIM ${TM_FILENAME_BASE} ============================*"
    ]
  },
  "Template IIB": {
    "prefix": "iib",
    "body": [
      "      *================================================================*",
      "      * SISTEMA...: ACH - ACOMPANHAMENTO DE CHEQUE-OURO",
      "      * PROGRAMA..: ${TM_FILENAME_BASE}",
      "      * ANALISTA..: F7023235 - MATHEUS SANTIAGO",
      "      * AUTOR.....: F7023235 - MATHEUS SANTIAGO",
      "      * DATA......: $CURRENT_DATE/$CURRENT_MONTH/$CURRENT_YEAR",
      "      * SERVICO...: 000000",
      "      * OPERACAO..: XXXXXXX.1",
      "      * COMPILACAO: 54 - PSOSE600 - Cobol 6.3 c/otimizacao p/producao",
      "      * OBJETIVO..:",
      "      * ...........",
      "      *================================================================*",
      "      *  [VRS001] | $CURRENT_DATE/$CURRENT_MONTH/$CURRENT_YEAR F7023235 - IMPLANTAÇÃO",
      "      *================================================================*",
      "      *",
      "      *************************",
      "       IDENTIFICATION DIVISION.",
      "        PROGRAM-ID. ${TM_FILENAME_BASE}.",
      "        AUTHOR. F7023235.",
      "      *************************",
      "      *",
      "      **********************",
      "       ENVIRONMENT DIVISION.",
      "      **********************",
      "       CONFIGURATION SECTION.",
      "       SPECIAL-NAMES.",
      "           DECIMAL-POINT IS COMMA.",
      "      *",
      "      ***************",
      "       DATA DIVISION.",
      "      ***************",
      "      *",
      "      *-----------------------------------------------------------------",
      "       WORKING-STORAGE SECTION.",
      "      *-----------------------------------------------------------------",
      "      *",
      "       COPY ALMKCBL1. *> Book necessário para realizar o mock",
      "      *",
      "      *----------------------- P R O G R A M A S ----------------------*",
      "      *",
      "       01 TAB-PROGRAMAS-CHAMADOS.",
      "           03  SBTIMEDT                 PIC  X(008) VALUE 'SBTIMEDT'.",
      "           03  SBDATAF                  PIC  X(007) VALUE 'SBDATAF'.",
      "           03  SBCPU                    PIC  X(005) VALUE 'SBCPU'.",
      "",
      "      *",
      "      *--------------------- C O N S T A N T E S ----------------------*",
      "      *",
      "       77  CTE-PROG                     PIC  X(016)",
      "                                        VALUE '*** ${TM_FILENAME_BASE} ***'.",
      "       77  CTE-VERS                     PIC  X(006) VALUE 'VRS001'.",
      "       77  CTE-ID-OPR                   PIC  9(008) VALUE ZEROES.",
      "      *",
      "      *-----------------------------------------------------------------",
      "       LOCAL-STORAGE SECTION.",
      "      *-----------------------------------------------------------------",
      "      *",
      "      *",
      "      *-------------------- I N D I C A D O R E S ---------------------*",
      "      *",
      "      *",
      "      *-----------------------  G U A R D A S -------------------------*",
      "      *",
      "       77  GDA-RESP                        PIC S9(04) COMP VALUE ZEROES.",
      "       77  GDA-SEQL-ERRO                   PIC  9(05)  VALUE ZEROS.",
      "       77  GDA-TAM-RESPOSTA                PIC S9(08)  COMP VALUE ZEROS.",
      "       77  GDA-SQLCODE                     PIC  ++++9.",
      "       77  GDA-NOME-CANAL                  PIC  X(016) VALUE SPACES.",
      "      *",
      "      *+---------------------------------------------------------------+",
      "      *|            Variaveis utilizadas na chamada da SBCPU           |",
      "      *+---------------------------------------------------------------+",
      "       01  GDA-SBCPU                   PIC  X(004).",
      "       01  FILLER REDEFINES GDA-SBCPU.",
      "           03 SBCPU-AMBIENTE           PIC  X(003).",
      "              88 SBCPU-EH-DESENV       VALUE 'DES'.",
      "              88 SBCPU-EH-HOMOLOGA     VALUE 'HOM'.",
      "              88 SBCPU-EH-PRODUCAO     VALUE 'BSB' 'BS2'.",
      "           03 FILLER                   PIC  X(001).",
      "      *+---------------------------------------------------------------+",
      "      *|          Variaveis utilizadas na chamada da SBTIMEDT          |",
      "      *+---------------------------------------------------------------+",
      "       01  GDA-SBTIME-FUNCAO           PIC  X(0003) VALUE 'F01'.",
      "       01  GDA-SBTIME-WK-AREA.",
      "           03  WK-AREA-TAM             PIC  9(0009) COMP VALUE 1024.",
      "           03  WK-AREA-DADOS           PIC  X(1024) VALUE SPACES.",
      "       01  GDA-SBTIME-FORMATO          PIC  X(0002) VALUE X'0002'.",
      "       01  GDA-SBTIME-TAMANHO          PIC  X(0002) VALUE X'001A'.",
      "       01  GDA-SBTIME-TIMESTAMP        PIC  X(026).",
      "       01  FILLER REDEFINES GDA-SBTIME-TIMESTAMP.",
      "           03  GDA-TS-DATA             PIC  X(010).",
      "           03  FILLER REDEFINES GDA-TS-DATA.",
      "               05  GDA-TS-ANO          PIC  X(004). *> YYYY",
      "               05  FILLER              PIC  X(001). *> .",
      "               05  GDA-TS-MES          PIC  X(002). *> MM",
      "               05  FILLER              PIC  X(001). *> .",
      "               05  GDA-TS-DIA          PIC  X(002). *> DD",
      "           03  FILLER                  PIC  X(016).",
      "      * +--------------------------------------------------------------+",
      "      * |          Variaveis utilizadas na chamada da SBDATAF.         |",
      "      * +--------------------------------------------------------------+",
      "       01  SBDATAF-AREAWORK            PIC  X(4095) VALUE SPACES.",
      "       01  FILLER REDEFINES SBDATAF-AREAWORK.",
      "           03  A-TAM                   PIC  9(0008)  COMP.",
      "           03  FILLER                  PIC  X(4071).",
      "           03  A-FIM                   PIC  X(0020).",
      "      *-----------------------------------------------------------------",
      "      *  260100-PEGA-ULTIMO-DIA-MES",
      "      *-----------------------------------------------------------------",
      "       77  SBDATAF-FUNCAO                   PIC  X(003) VALUE 'F16'.",
      "       77  SBDATAF-F16-ULT-DIA-MES-DMA-E1   PIC  9(008).",
      "       77  SBDATAF-F16-ULT-DIA-MES-NULL     PIC  9(008).",
      "       77  SBDATAF-F16-ULT-DIA-MES-S1       PIC  9(008).",
      "      *",
      "      *-------------------------- B O O K S ---------------------------*",
      "      *",
      "      *----------------------------------------------------------------*",
      "      * XXXXXXXX - Book de entrada do programa.                        *",
      "      *----------------------------------------------------------------*",
      "      *",
      "       COPY XXXXXXXX.",
      "      *",
      "      *----------------------------------------------------------------*",
      "      * IIBKSRVC - Interface com o sistema IIB                         *",
      "      *----------------------------------------------------------------*",
      "      *",
      "       COPY IIBKSRVC.",
      "      *",
      "      *----------------------------------------------------------------*",
      "      * IIBKOPRD - Book contendo o código do usuário logado            *",
      "      *----------------------------------------------------------------*",
      "      *",
      "       COPY IIBKOPRD.",
      "      *",
      "      *----------------------------------------------------------------*",
      "      * IIBKERRO - Variáveis para rotina de erro do IIB                *",
      "      *----------------------------------------------------------------*",
      "      *",
      "       COPY IIBKERRO.",
      "      *",
      "      *----------------------------------------------------------------*",
      "      * MSGKWMG1 - Variáveis para acionamento do MSG1                  *",
      "      *----------------------------------------------------------------*",
      "      *",
      "       COPY MSGKWMG1.",
      "      *",
      "      *--------------------------- S Q L ------------------------------*",
      "      *",
      "           EXEC SQL",
      "              INCLUDE SQLCA",
      "           END-EXEC.",
      "      *",
      "      ********************",
      "       PROCEDURE DIVISION.",
      "      ********************",
      "      *",
      "       COPY ALMKCBL2. *> Book necessário para realizar o mock",
      "      *",
      "      *----------------------------------------------------------------*",
      "       000000-ROTINA-PRINCIPAL                                  SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "      *--- PROCEDIMENTOS INICIAIS",
      "           PERFORM 100000-INICIA-VARIAVEIS.",
      "           PERFORM 110000-VALIDA-SERVICO-IIB.",
      "           PERFORM 120000-RECEBE-DADOS-IIB.",
      "           PERFORM 130000-PEGA-NOME-CANAL.",
      "           PERFORM 140000-VALIDA-PARAMETROS.",
      "           PERFORM 150000-VERIFICA-AMBIENTE.",
      "           PERFORM 160000-MONTA-DATA-ATUAL.",
      "",
      "      *--- PROCESSA",
      "",
      "      *--- FINALIZA",
      "           PERFORM 300000-GRAVA-RETORNO-IIB.",
      "",
      "           EXEC CICS",
      "                RETURN",
      "           END-EXEC.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       100000-INICIA-VARIAVEIS                                  SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           INITIALIZE ${TM_FILENAME_BASE}-RQSC",
      "                      ${TM_FILENAME_BASE}-RPST",
      "                      MSGS0001-PRM.",
      "      *",
      "       100099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       110000-VALIDA-SERVICO-IIB                                SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           EXEC CICS GET",
      "              CONTAINER ( 'PRM-RQSC-SRVC'              )",
      "                   INTO ( SRVC-PRM-RQSC-SRVC           )",
      "                FLENGTH ( LENGTH OF SRVC-PRM-RQSC-SRVC )",
      "                   RESP ( GDA-RESP                     )",
      "           END-EXEC.",
      "      *",
      "           IF GDA-RESP NOT EQUAL DFHRESP(NORMAL)",
      "              MOVE 01                TO GDA-SEQL-ERRO",
      "              PERFORM 990100-ERRO-CICS",
      "           END-IF.",
      "",
      "      *--- Valida servico e operação correspondentes a transação execu-",
      "      *--- tada.",
      "           IF ((SRVC-ID-SRVC NOT NUMERIC)       OR",
      "               (SRVC-ID-SRVC NOT EQUAL ZEROS))  OR",
      "              ((SRVC-ID-OPR  NOT NUMERIC)       OR",
      "               (SRVC-ID-OPR  NOT EQUAL CTE-ID-OPR))",
      "               PERFORM 990001-ERRO-01",
      "           END-IF.",
      "",
      "      *",
      "       110099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       120000-RECEBE-DADOS-IIB                                  SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           EXEC CICS GET",
      "               CONTAINER ( '${TM_FILENAME_BASE}-RQSC'  )",
      "               NODATA",
      "               FLENGTH   ( GDA-TAM-RESPOSTA )",
      "               RESP      ( GDA-RESP         )",
      "           END-EXEC.",
      "      *",
      "           IF GDA-RESP NOT EQUAL DFHRESP(NORMAL)",
      "              MOVE 02 TO GDA-SEQL-ERRO",
      "              PERFORM 990100-ERRO-CICS",
      "           END-IF",
      "",
      "",
      "           EXEC CICS GET",
      "               CONTAINER ( '${TM_FILENAME_BASE}-RQSC'  )",
      "               INTO      ( ${TM_FILENAME_BASE}-RQSC    )",
      "               FLENGTH   ( GDA-TAM-RESPOSTA )",
      "               RESP      ( GDA-RESP         )",
      "           END-EXEC.",
      "",
      "           IF GDA-RESP NOT EQUAL DFHRESP(NORMAL)",
      "              MOVE 03 TO GDA-SEQL-ERRO",
      "              PERFORM 990100-ERRO-CICS",
      "           END-IF.",
      "      *",
      "       120099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       130000-PEGA-NOME-CANAL                                   SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           EXEC CICS ASSIGN",
      "              CHANNEL ( GDA-NOME-CANAL )",
      "              RESP    ( GDA-RESP       )",
      "           END-EXEC",
      "",
      "           IF GDA-RESP NOT EQUAL DFHRESP(NORMAL)",
      "               MOVE 004 TO GDA-SEQL-ERRO",
      "               PERFORM 990100-ERRO-CICS",
      "           END-IF.",
      "      *",
      "       130099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       140000-VALIDA-PARAMETROS                                 SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "",
      "      *",
      "       140099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       150000-VERIFICA-AMBIENTE                                 SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           CALL SBCPU USING GDA-SBCPU.",
      "      *",
      "           IF RETURN-CODE NOT EQUAL ZEROES",
      "              PERFORM 990002-ERRO-02",
      "           END-IF.",
      "      *",
      "       150099-SAI.",
      "           EXIT.",
      "      *",
      "      *-----------------------------------------",
      "       160000-MONTA-DATA-ATUAL          SECTION.",
      "      *-----------------------------------------",
      "      *",
      "           CALL SBTIMEDT USING GDA-SBTIME-FUNCAO",
      "                               GDA-SBTIME-WK-AREA",
      "                               GDA-SBTIME-FORMATO",
      "                               GDA-SBTIME-TAMANHO",
      "                               GDA-SBTIME-TIMESTAMP.",
      "",
      "           IF RETURN-CODE NOT EQUAL 0",
      "              PERFORM 990003-ERRO-03",
      "           END-IF.",
      "      *",
      "       160099-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       300000-GRAVA-RETORNO-IIB                                 SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           EXEC CICS PUT",
      "               CONTAINER ( '${TM_FILENAME_BASE}-RPST'         )",
      "                    FROM ( ${TM_FILENAME_BASE}-RPST           )",
      "                 FLENGTH ( LENGTH OF ${TM_FILENAME_BASE}-RPST )",
      "                    RESP ( GDA-RESP                )",
      "           END-EXEC",
      "      *",
      "           IF GDA-RESP NOT EQUAL DFHRESP(NORMAL)",
      "               MOVE 005 TO GDA-SEQL-ERRO",
      "               PERFORM 990100-ERRO-CICS",
      "           END-IF.",
      "",
      "           IF IIBKERRO-CD-ERRO EQUAL 0",
      "              MOVE ' EXECUTADO COM SUCESSO.'   TO IIBKERRO-TX-ERRO",
      "           END-IF.",
      "      *",
      "       300099-SAI.",
      "           EXIT.",
      "      *",
      "      *================================================================*",
      "       990000-ERROS                                             SECTION.",
      "      *================================================================*",
      "      *",
      "      *",
      "       990001-ERRO-01.",
      "           SET ERRO-PROGRAMADO        TO TRUE.",
      "           MOVE 001                   TO MSG1-CD-ERRO-TS",
      "                                         IIBKERRO-CD-ERRO.",
      "           MOVE 001                   TO MSG1-CD-SEQL-ERRO.",
      "      *    -------------------------------------------------------------",
      "           MOVE 'Ocorreu um erro, tente novamente.' TO IIBKERRO-TX-ERRO.",
      "      *    -------------------------------------------------------------",
      "           PERFORM 990300-GRAVA-ERRO-IIB.",
      "           PERFORM 999999-ABENDA.",
      "",
      "       990002-ERRO-02.",
      "           SET ERRO-PROGRAMA-ACIONADO TO TRUE.",
      "           MOVE 999                   TO MSG1-CD-ERRO-TS",
      "                                         IIBKERRO-CD-ERRO.",
      "           MOVE 002                   TO MSG1-CD-SEQL-ERRO.",
      "           MOVE 'Transação indisponível, tente mais tarde.'",
      "                                      TO IIBKERRO-TX-ERRO.",
      "      *    ----------------------------------------------------",
      "           MOVE 'SBCPU'               TO MSG1-NM-PGM-ACND.",
      "           MOVE RETURN-CODE           TO MSG1-CD-RTN-PGM-ACND.",
      "           MOVE 'Erro chamada SBCPU'  TO MSG1-TX-RTN-PGM-ACND.",
      "      *    ----------------------------------------------------",
      "           PERFORM 990300-GRAVA-ERRO-IIB.",
      "           PERFORM 999999-ABENDA.",
      "",
      "       990003-ERRO-03.",
      "           SET ERRO-PROGRAMA-ACIONADO  TO TRUE.",
      "           MOVE 999                    TO MSG1-CD-ERRO-TS",
      "                                          IIBKERRO-CD-ERRO.",
      "           MOVE 003                    TO MSG1-CD-SEQL-ERRO",
      "           MOVE 'Transação indisponível, tente mais tarde.'",
      "                                       TO IIBKERRO-TX-ERRO.",
      "      *    -----------------------------------------------------",
      "           MOVE 'SBTIMEDT'             TO MSG1-NM-PGM-ACND.",
      "           MOVE RETURN-CODE            TO MSG1-CD-RTN-PGM-ACND.",
      "           MOVE 'Erro chamada SBTIMEDT'TO MSG1-TX-RTN-PGM-ACND.",
      "      *    -----------------------------------------------------",
      "           PERFORM 990200-VRV-MONITORADA-ENTRADA.",
      "      *    -----------------------------------------------------",
      "           SET IC-V UP BY 1.",
      "           MOVE 'GDA-SBTIME-FUNCAO'    TO MSG1-NM-VRV-MON(IC-V).",
      "           MOVE GDA-SBTIME-FUNCAO      TO MSG1-VL-VRV-MON(IC-V).",
      "           ADD 1                       TO MSG1-QT-VRV-MNT.",
      "      *    -----------------------------------------------------",
      "           SET IC-V UP BY 1.",
      "           MOVE 'GDA-SBTIME-FORMATO'   TO MSG1-NM-VRV-MON(IC-V).",
      "           MOVE GDA-SBTIME-FORMATO     TO MSG1-VL-VRV-MON(IC-V).",
      "           ADD 1                       TO MSG1-QT-VRV-MNT.",
      "      *    -----------------------------------------------------",
      "           SET IC-V UP BY 1.",
      "           MOVE 'GDA-SBTIME-TAMANHO'   TO MSG1-NM-VRV-MON(IC-V).",
      "           MOVE GDA-SBTIME-TAMANHO     TO MSG1-VL-VRV-MON(IC-V).",
      "           ADD 1                       TO MSG1-QT-VRV-MNT.",
      "      *    -----------------------------------------------------",
      "           PERFORM 990300-GRAVA-ERRO-IIB.",
      "           PERFORM 999999-ABENDA.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       990100-ERRO-CICS                                         SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           SET ERRO-CICS              TO TRUE.",
      "           MOVE 999                   TO MSG1-CD-ERRO-TS",
      "                                         IIBKERRO-CD-ERRO.",
      "           MOVE GDA-SEQL-ERRO         TO MSG1-CD-SEQL-ERRO.",
      "           MOVE 'Transação indisponível, tente mais tarde.'",
      "                                      TO IIBKERRO-TX-ERRO.",
      "",
      "           PERFORM 990300-GRAVA-ERRO-IIB.",
      "           PERFORM 999999-ABENDA.",
      "      *",
      "       990199-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       990200-VRV-MONITORADA-ENTRADA                            SECTION.",
      "      *----------------------------------------------------------------*",
      "      * Coloca as variáveis de entrada para serem monitoradas pelo MSG1",
      "      *----------------------------------------------------------------*",
      "      *",
      "      *--- Exemplo: input de agencia e conta",
      "      *    SET IC-V                    TO 1.",
      "      *    MOVE '${TM_FILENAME_BASE}-CD-UOR-CC-E' TO MSG1-NM-VRV-MON(IC-V).",
      "      *    MOVE '${TM_FILENAME_BASE}-CD-UOR-CC-E  TO MSG1-VL-VRV-MON(IC-V).",
      "      *    ADD 1                                  TO MSG1-QT-VRV-MNT.",
      "      *    -----------------------------------------------------",
      "      *    SET IC-V UP BY 1.",
      "      *    MOVE '${TM_FILENAME_BASE}-NR-CC-E'     TO MSG1-NM-VRV-MON(IC-V).",
      "      *    MOVE '${TM_FILENAME_BASE}-NR-CC-E      TO MSG1-VL-VRV-MON(IC-V).",
      "      *    ADD 1                                  TO MSG1-QT-VRV-MNT.",
      "      *",
      "       990299-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       990300-GRAVA-ERRO-IIB                                    SECTION.",
      "      *----------------------------------------------------------------*",
      "      * Monta o Registro de Erro do IIB",
      "      *----------------------------------------------------------------*",
      "           MOVE IIBKERRO-TX-ERRO        TO MSG1-TX-ERRO-TS.",
      "",
      "           EVALUATE TRUE",
      "               WHEN ERRO-PROGRAMADO",
      "                   CONTINUE",
      "               WHEN ERRO-PROGRAMA-ACIONADO",
      "                   SET IC-V UP BY 1",
      "                   MOVE 'Programa acionado' TO MSG1-NM-VRV-MON(IC-V)",
      "                   MOVE MSG1-NM-PGM-ACND",
      "                                        TO MSG1-VL-VRV-MON(IC-V)",
      "                   ADD 1                TO MSG1-QT-VRV-MNT",
      "      *            ----------------------------------------------",
      "                   SET IC-V UP BY 1",
      "                   MOVE 'Codigo de retorno do programa'",
      "                                        TO MSG1-NM-VRV-MON(IC-V)",
      "                   MOVE MSG1-CD-RTN-PGM-ACND",
      "                                        TO MSG1-VL-VRV-MON(IC-V)",
      "                   ADD 1                TO MSG1-QT-VRV-MNT",
      "      *            ----------------------------------------------",
      "                   SET IC-V UP BY 1",
      "                   MOVE 'Sequencial do erro do programa'",
      "                                        TO MSG1-NM-VRV-MON(IC-V)",
      "                   MOVE MSG1-CD-SEQL-PGM-ACND",
      "                                        TO MSG1-VL-VRV-MON(IC-V)",
      "                   ADD 1                TO MSG1-QT-VRV-MNT",
      "      *            ----------------------------------------------",
      "                   SET IC-V UP BY 1",
      "                   MOVE 'Texto de retorno do programa'",
      "                                        TO MSG1-NM-VRV-MON(IC-V)",
      "                   MOVE MSG1-TX-RTN-PGM-ACND",
      "                                        TO MSG1-VL-VRV-MON(IC-V)",
      "                   ADD 1                TO MSG1-QT-VRV-MNT",
      "",
      "               WHEN ERRO-SERVICO-OPERACAO-ACIONADA",
      "                   MOVE SRVC-ID-SRVC    TO MSG1-CD-SRVC-ACND",
      "                   MOVE SRVC-VRS-SRVC   TO MSG1-CD-VRS-SRVC-ACND",
      "                   MOVE SRVC-ID-OPR     TO MSG1-CD-OPR-ACND",
      "                   MOVE SRVC-VRS-OPR    TO MSG1-CD-VRS-OPR-ACND",
      "      *            ---------------------------------------------",
      "                   SET IC-V UP BY 1",
      "                   MOVE 'GDA-OPR-ACND'    TO MSG1-NM-VRV-MON(IC-V)",
      "                   MOVE MSGS0001-OPR-ACND TO MSG1-VL-VRV-MON(IC-V)",
      "                   ADD 1                  TO MSG1-QT-VRV-MNT",
      "",
      "               WHEN ERRO-SQL",
      "                   MOVE SQLCA           TO MSG1-SQLCA",
      "                   MOVE SQLCODE         TO GDA-SQLCODE",
      "      *            ----------------------------------------------",
      "                   SET IC-V UP BY 1",
      "                   MOVE 'SQLCODE'       TO MSG1-NM-VRV-MON(IC-V)",
      "                   MOVE GDA-SQLCODE     TO MSG1-VL-VRV-MON(IC-V)",
      "                   ADD 1                TO MSG1-QT-VRV-MNT",
      "               WHEN ERRO-CICS",
      "                   SET IC-V             TO 1",
      "                   MOVE 'EIBRESP'       TO MSG1-NM-VRV-MON(IC-V)",
      "                   MOVE EIBRESP         TO MSG1-VL-VRV-MON(IC-V)",
      "                   ADD 1                TO MSG1-QT-VRV-MNT",
      "      *            ----------------------------------------------",
      "                   SET IC-V UP BY 1",
      "                   MOVE 'EIBRESP2'      TO MSG1-NM-VRV-MON(IC-V)",
      "                   MOVE EIBRESP2        TO MSG1-VL-VRV-MON(IC-V)",
      "                   ADD 1                TO MSG1-QT-VRV-MNT",
      "           END-EVALUATE.",
      "      *",
      "           PERFORM MSG1-NTF-MSG.",
      "",
      "           IF NOT MSG1-OK-EXEC",
      "              PERFORM 990300-GRAVA-ERRO-INTEGRACAO",
      "              PERFORM 999999-ABENDA",
      "           END-IF.",
      "",
      "           MOVE MSG1-CD-ERRO-TS        TO IIBKERRO-CD-ERRO.",
      "           MOVE MSG1-TX-ERRO-TS        TO IIBKERRO-TX-ERRO.",
      "",
      "           EXEC CICS PUT",
      "              CONTAINER ( 'PRM-ERRO'                  )",
      "                   FROM ( IIBKERRO-PRM-ERRO           )",
      "                FLENGTH ( LENGTH OF IIBKERRO-PRM-ERRO )",
      "               NOHANDLE",
      "           END-EXEC.",
      "      *",
      "       990399-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       990300-GRAVA-ERRO-INTEGRACAO                             SECTION.",
      "      *----------------------------------------------------------------*",
      "      * Monta o Registro de Erro Integração",
      "      *----------------------------------------------------------------*",
      "      *",
      "           EXEC CICS PUT",
      "              CONTAINER ( 'PRM-ERRO'                  )",
      "                CHANNEL ( GDA-NOME-CANAL              )",
      "                   FROM ( IIBKERRO-PRM-ERRO           )",
      "                FLENGTH ( LENGTH OF IIBKERRO-PRM-ERRO )",
      "               NOHANDLE",
      "           END-EXEC.",
      "      *",
      "       990399-SAI.",
      "           EXIT.",
      "      *",
      "      *----------------------------------------------------------------*",
      "       999999-ABENDA                                            SECTION.",
      "      *----------------------------------------------------------------*",
      "      *",
      "           EXEC CICS",
      "               RETURN",
      "               NOHANDLE",
      "           END-EXEC.",
      "      *",
      "       999999-SAI.",
      "           EXIT.",
      "      *",
      "       COPY MSGKPMG1. *> Book de notificação do MSG",
      "      *====================== FIM ${TM_FILENAME_BASE} ============================*"
    ]
  }
}
